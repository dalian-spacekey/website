---
layout: post
title: Postfix+Dovecotで失敗
date: 2013-12-04
tags: ["CentOS"]
---

作っているWebアプリケーションの道筋がちょっと付いてきたので、ドメインを取ってサーバーを構築しております。

その際、メールの送受信なんかが含まれることもあってメールサーバーを構築しました。
その昔自宅で固定IPを取得してサーバーなんかを立てていた頃は、qmailとか使っていたんですが、最近はPostfixが主流のようですね。

[さくらVPSのCentOS 6.3にメールサーバ Postfix/Dovecotをインストール](http://morizyun.github.io/blog/postfix-centos-sakura-vps-aws/) - [酒と泪とRubyとRailsと](http://morizyun.github.io/)

を全面的に参考にさせて頂いて、さくっと構築しました。

......が

なんか、何回も設定を見直しても、外からのメールが構築したメールサーバーに入ってこない。
サーバー内で送ったりすれば当然届くし、DNSも確かに設定しているはず......

と色々悩むこと数時間後。

MXレコードが、@の中ではなく、別のところに入っておりましたとさ。

今回、サービス用に使うサーバーではなく、既に借りている別のサーバーにPostfixを設定したんですが、その際に間違ってMXレコードを登録していたのに気がついてなかったのです。

    @    NS    ns1.dns.ne.jp.
         NS    ns2.dns.ne.jp.
         A     192.168.1.1
         MX    10 mail.example.com.
    mail A     192.168.1.2

となっていないといけないのに、

    @    NS    ns1.dns.ne.jp.
         NS    ns2.dns.ne.jp.
         A     192.168.1.1
    mail A     192.168.1.2
         MX    10 mail.example.com.

と、なんかこんなところにMXレコードを作ってしまっていました。
DNSの設定も何回か見直したはずなんですが、思い込みというのはいけませんな。

### 追伸

設定が変なときにばんばん送っていた迷子のメールたちが一斉に届きましたよ。